% Add required packages
\usepackage{pdfpages}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{colortbl}
\usepackage{array}
\usepackage{graphicx}
\usepackage{afterpage}

% Set page geometry for whole document
\geometry{
  a4paper,
  top=15mm,
  bottom=\revisionTableHeight,
  left=20mm,
  right=15mm,
  includeheadfoot
}

% Set header height
\setlength{\headheight}{85pt}

% Ensure header occupies full width
\setlength{\headwidth}{\textwidth}
\addtolength{\headwidth}{-24mm}

\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancyhead{} % clear all header fields

\fancyhead[C]{%
  \begin{tabular*}{\textwidth}{|l@{\extracolsep{\fill}}c@{\extracolsep{\fill}}r@{\extracolsep{\fill}}r|}
    \hline
    %  first row
    \raisebox{-0.5\height}{\includegraphics[height=1.5cm]{\logoCompany}} & 
    \multicolumn{2}{c}{\textbf{\fontsize{24}{29}\selectfont Calculation Sheet}} & 
    \raisebox{-0.5\height}{\includegraphics[height=1.5cm]{\logoClient}} \\ 
    \hline
    % 2nd row
    \multicolumn{1}{|l|}{\textbf{\fontsize{9}{11}\selectfont Project Title}} & 
    \multicolumn{1}{l}{\fontsize{9}{11}\selectfont \projTitle} & 
    \multicolumn{1}{|l|}{\textbf{\fontsize{9}{11}\selectfont Project No.}} & 
    \multicolumn{1}{l|}{\fontsize{9}{11}\selectfont \projNo} \\ 
    \cline{1-4}
    % 3rd row
    \multicolumn{1}{|l|}{\textbf{\fontsize{9}{11}\selectfont Client}} & 
    \multicolumn{1}{l}{\fontsize{9}{11}\selectfont \client} & 
    \multicolumn{1}{|l|}{\textbf{\fontsize{9}{11}\selectfont Calculation No.}} & 
    \multicolumn{1}{l|}{\fontsize{9}{11}\selectfont \calcNumber} \\ 
    \cline{1-4}
    %  4th row
    \multicolumn{1}{|l|}{\textbf{\fontsize{9}{11}\selectfont Calculation Title}} & 
    \multicolumn{1}{l}{\fontsize{9}{11}\selectfont \calcTitle} & 
    \multicolumn{1}{|l|}{\textbf{\fontsize{9}{11}\selectfont Revision}} & 
    \multicolumn{1}{l|}{\fontsize{9}{11}\selectfont \revNo} \\ 
    \cline{1-4}
    %  5th row
    \multicolumn{1}{|p{27mm}|}{\textbf{\fontsize{9}{11}\selectfont Project Phase}} & 
    \multicolumn{1}{l}{\fontsize{9}{11}\selectfont \projPhase} & 
    \multicolumn{1}{|p{25mm}|}{\textbf{\fontsize{9}{11}\selectfont Date}} & 
    \multicolumn{1}{p{25mm}|}{\fontsize{9}{11}\selectfont \calcDate} \\ 
    \cline{1-4}
  \end{tabular*}%
}  

% Define a custom page style for the first page, which includes the revision table

\fancypagestyle{firstpage}{  
    \fancyfoot[C]{% 
        \begin{tabular*}{\textwidth}{|p{8mm}|p{15mm}|c|p{20mm}|p{20mm}|p{20mm}|}
            \hline
            \multicolumn{1}{|>{\columncolor{black}\color{white}}l|}{\textbf{\fontsize{9}{11}\selectfont Rev.}} & 
            \multicolumn{1}{>{\columncolor{black}\color{white}}l|}{\textbf{\fontsize{9}{11}\selectfont Date}} & 
            \multicolumn{1}{>{\columncolor{black}\color{white}}l|}{\textbf{\fontsize{9}{11}\selectfont Description}} & 
            \multicolumn{1}{>{\columncolor{black}\color{white}}l|}{\textbf{\fontsize{9}{11}\selectfont Prepared}} & 
            \multicolumn{1}{>{\columncolor{black}\color{white}}l|}{\textbf{\fontsize{9}{11}\selectfont Checked}} & 
            \multicolumn{1}{>{\columncolor{black}\color{white}}l|}{\textbf{\fontsize{9}{11}\selectfont Approved}} \\ 
            \revisionData
            % \hline
        \end{tabular*}

        % add following disclaimer: 
        \vskip 2mm
        \begin{minipage}{\textwidth}
            \fontsize{8}{11}\selectfont This calculation was prepared by \companyName\ pursuant to the Engineering Services Contract between \companyName\ and \client\ in connection with the services for \projTitle.
        \end{minipage}
    } 
}

% show first page style
\thispagestyle{firstpage}
 
% how to show the remaineder of the pages without the footer, and new bottom margin 


 


